import{C as e,o as l,d as a,b as t,f as o,P as r,c as s,h as n,aS as u,v as i,aT as c,x as d,J as v,r as p,ae as m,af as f,aR as y,aU as b,F as g,l as k,a as w,R as h,t as x,K as C,g as $,e as j,w as S,q as T,m as H}from"./index-2b32231c.js";const R=["data-th"],V=e({__name:"VFlexTableCell",props:{column:{default:()=>({})}},setup(e){const r=e;return(e,s)=>(l(),a("div",{class:o(["flex-table-cell is-relative",[r.column.bold&&"is-bold",r.column.media&&"is-media",!0===r.column.grow&&"is-grow","lg"===r.column.grow&&"is-grow-lg","xl"===r.column.grow&&"is-grow-xl",r.column.scrollX&&!r.column.scrollY&&"has-slimscroll-x",!r.column.scrollX&&r.column.scrollY&&"has-slimscroll",r.column.scrollX&&r.column.scrollY&&"has-slimscroll-all","end"===r.column.align&&"cell-end","center"===r.column.align&&"cell-center",r.column.cellClass]]),"data-th":r.column.label||void 0},[t(e.$slots,"default")],10,R))}}),B=e({props:{id:{type:String,required:!0},label:{type:String,default:void 0},modelValue:{type:String,default:void 0},noRouter:{type:Boolean,default:void 0},routerQueryKey:{type:String,default:"sort"}},emits:["update:modelValue"],setup(e,l){const a=r(),t=s((()=>e.modelValue??a.query[e.routerQueryKey]??"")),o=s((()=>t.value===`${e.id}:asc`)),i=s((()=>t.value===`${e.id}:desc`)),c=s((()=>o.value?`${e.id}:desc`:i.value?void 0:`${e.id}:asc`)),d=s((()=>{if(e.noRouter)return{};const l={...a.query};return e.routerQueryKey&&(l[e.routerQueryKey]=c.value),{name:a.name,params:a.params,query:l}})),v=a=>{if(l.emit("update:modelValue",c.value),e.noRouter)return a.preventDefault(),a.stopPropagation(),!1};return()=>{var a,r;const s=null==(r=null==(a=l.slots)?void 0:a.default)?void 0:r.call(a,{isDesc:i.value,isAsc:o.value,nextSort:c.value,value:t.value}),p=n(u,{to:d.value,onClick:v,onKeydown(e){"Space"===e.code&&(e.preventDefault(),e.stopPropagation(),e.target instanceof HTMLAnchorElement&&e.target.dispatchEvent(new MouseEvent("click")))}},{default(){const l=n("span",{key:`${t.value}`,class:"is-inline"},n("span",{class:"ml-3 iconify is-inline","data-icon":o.value?"fa:sort-asc":i.value?"fa:sort-desc":"fa:sort"}));return[s??e.label,l]}});return n("span",{},p)}}}),K=Symbol(),O=e=>e,_=({key:e,order:l,a:a,b:t})=>{const o=a[e],r=t[e];return"string"==typeof o?"asc"===l?o.localeCompare(r):r.localeCompare(o):o>r?"asc"===l?1:-1:o<r?"asc"===l?-1:1:0};e({props:{data:{type:[Array,Function],default:void 0},columns:{type:Object,default:void 0},sort:{type:String,default:void 0},searchTerm:{type:String,default:void 0},limit:{type:Number,default:void 0},page:{type:Number,default:void 0},total:{type:Number,default:void 0},debounceSearch:{type:Number,default:300}},emits:["update:sort","update:page","update:limit","update:searchTerm"],setup(e,l){const a=i(),t=i(!1),o=i(""),r=s({get:()=>e.sort??o.value,set(a){void 0===e.sort?o.value=a:l.emit("update:sort",a)}}),u=i(""),f=s({get:()=>e.searchTerm??u.value,set(a){void 0===e.searchTerm?u.value=a:l.emit("update:searchTerm",a)}}),y=i(1),b=s({get:()=>e.page??y.value,set(a){void 0===e.page?y.value=a:l.emit("update:page",a)}}),g=i(10),k=s({get:()=>Math.max(1,e.limit??g.value),set(a){void 0===e.limit?g.value=a:l.emit("update:limit",a)}}),w=s((()=>{const l=e.columns;if(!l)return l;const a={};return Object.keys(l).reduce(((e,a)=>{const t=l[a];return"string"==typeof t?e[a]={format:O,label:t,key:a}:"object"==typeof t&&(e[a]={format:O,label:a,key:a,...t},!0===t.sortable&&(t.renderHeader?e[a].renderHeader=()=>n(B,{id:a,noRouter:!0,modelValue:r.value,"onUpdate:modelValue":e=>r.value=e},{default:t.renderHeader}):e[a].renderHeader=()=>n(B,{id:a,label:t.label??a,noRouter:!0,modelValue:r.value,"onUpdate:modelValue":e=>r.value=e})),!0!==t.searchable||t.sort||(e[a].sort=_)),e}),a),a})),h=s((()=>{let l=a.value;if(!l)return l;if("function"==typeof e.data)return l;if($.value){const e=w.value?Object.values(w.value).filter((e=>!(!e||"string"==typeof e)&&!0===e.searchable)):[];if(e.length){const a=new RegExp($.value,"i");l=l.filter(((l,t)=>e.some((e=>{if(!e.key)return!1;const o=l[e.key];return e.filter?e.filter({searchTerm:$.value,value:o,row:l,column:e,index:t}):"string"==typeof o&&o.match(a)}))))}}return l})),x=s((()=>{let l=h.value;if(!l)return l;if("function"==typeof e.data)return l;if(r.value&&r.value.includes(":")){const[e,a]=r.value.split(":"),t=w.value?Object.values(w.value).find((l=>!(!l||"string"==typeof l)&&(!0===l.sortable&&l.key===e))):null;if(t){const e=[...l];e.sort(((e,l)=>t.key&&t.sort?t.sort({order:a,column:t,key:t.key,a:e,b:l}):0)),l=e}}return l})),C=s((()=>{if("function"==typeof e.data)return a.value;if(!a.value)return a.value;let l=x.value;return null==l?void 0:l.slice(S.value,S.value+k.value)})),$=c(f,e.debounceSearch),j=s((()=>{var l;return e.total??(null==(l=x.value)?void 0:l.length)??0})),S=s((()=>(b.value-1)*k.value)),T=s((()=>j.value?Math.ceil(j.value/k.value):0));async function H(l){if("function"==typeof e.data){t.value=!0;try{a.value=await e.data({searchTerm:$.value,start:S.value,limit:k.value,sort:r.value,controller:l})}finally{t.value=!1}}}d([$,k],(()=>{1!==b.value&&(b.value=1)})),v((async l=>{let t;"function"==typeof e.data?(t=new AbortController,await H(t)):a.value=e.data,l((()=>{null==t||t.abort()}))}));const R=p({data:C,columns:w,loading:t,searchInput:f,searchTerm:$,start:S,page:b,limit:k,sort:r,total:j,totalPages:T,fetchData:H});return m(K,R),l.expose(R),()=>{var e,a;const t=null==(a=(e=l.slots).default)?void 0:a.call(e,R);return n("div",{class:"flex-table-wrapper"},t)}}});const q={key:0,class:"flex-table-header"},A=["tabindex","onKeydown","onClick"],D={key:0},E={class:"language-json py-4"},F=e({__name:"VFlexTable",props:{data:{default:()=>[]},columns:{default:void 0},printObjects:{type:Boolean},reactive:{type:Boolean},compact:{type:Boolean},rounded:{type:Boolean},separators:{type:Boolean},clickable:{type:Boolean},subtable:{type:Boolean},noHeader:{type:Boolean}},emits:["rowClick"],setup(e,{emit:r}){const n=e,u=f(K,null),i=s((()=>(null==u?void 0:u.data)?u.data:n.reactive?y(n.data)?n.data:p(n.data):b(n.data))),c=e=>e,d=s((()=>{const e=(null==u?void 0:u.columns)??n.columns;let l=[];if(e)for(const[a,t]of Object.entries(e))"string"==typeof t?l.push({format:c,label:t,key:a}):l.push({format:c,label:a,key:a,...t});else if(i.value.length>0)for(const[a]of Object.entries(i.value[0]))l.push({format:c,label:a,key:a});return l}));return(s,u)=>{const c=V;return l(),a("div",{class:o(["flex-table",[n.compact&&"is-compact",n.rounded&&"is-rounded",n.separators&&"with-separators",n.noHeader&&"no-header",n.clickable&&"is-table-clickable",n.subtable&&"sub-table"]])},[t(s.$slots,"header",{},(()=>[n.noHeader?$("",!0):(l(),a("div",q,[(l(!0),a(g,null,k(C(d),(e=>t(s.$slots,"header-column",{key:"col"+e.key,column:e},(()=>[e.renderHeader?(l(),w(h({render:e.renderHeader}),{key:0,class:o([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},null,8,["class"])):(l(),a("span",{key:1,class:o([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},x(e.label),3))])))),128))]))])),t(s.$slots,"body",{},(()=>[(l(!0),a(g,null,k(C(i),((u,i)=>(l(),a(g,{key:i},[t(s.$slots,"body-row-pre",{row:u,columns:C(d),index:i}),j("div",{class:o(["flex-table-item",[n.clickable&&"is-clickable"]]),tabindex:n.clickable?0:void 0,onKeydown:T(H((()=>{n.clickable&&r("rowClick",u,i)}),["prevent"]),["space"]),onClick:()=>{n.clickable&&r("rowClick",u,i)}},[t(s.$slots,"body-row",{row:u,columns:C(d),index:i},(()=>[(l(!0),a(g,null,k(C(d),(r=>(l(),w(c,{key:"row"+r.key,column:r},{default:S((()=>[t(s.$slots,"body-cell",{row:u,column:r,index:i,value:r.format(u[r.key],u,i)},(()=>[r.renderRow?(l(),w(h({render:()=>{var e;return null==(e=r.renderRow)?void 0:e.call(r,u,r,i)}}),{key:0})):"object"==typeof r.format(u[r.key],u,i)?(l(),a("span",{key:1,class:o([r.cellClass,r.inverted&&"dark-inverted",!r.inverted&&(r.bold?"dark-text":"light-text")])},[e.printObjects?(l(),a("details",D,[j("div",E,[j("pre",null,[j("code",null,x(r.format(u[r.key],u,i)),1)])])])):$("",!0)],2)):(l(),a("span",{key:2,class:o([r.cellClass,r.inverted&&"dark-inverted",!r.inverted&&(r.bold?"dark-text":"light-text")])},x(r.format(u[r.key],u,i)),3))]))])),_:2},1032,["column"])))),128))]))],42,A),t(s.$slots,"body-row-post",{row:u,columns:C(d),index:i})],64)))),128))]))],2)}}});export{V as _,F as a};
